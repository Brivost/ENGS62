#include <stdio.h>
#include <stdlib.h>
#include "servo.h"

/*
 * initializes servo motor control, setting dutycycle at 7.5%
 */
void servo_init(void) {
	/* outputing square waveform */
	XTmrCtr_Initialize(&tmrctr, XPAR_AXI_TIMER_0_DEVICE_ID);

	XTmrCtr_Stop(&tmrctr, 0);
	XTmrCtr_Stop(&tmrctr, 1);

	XTmrCtr_SetOptions(&tmrctr, 0, XTC_DOWN_COUNT_OPTION | XTC_EXT_COMPARE_OPTION | XTC_PWM_ENABLE_OPTION );
	XTmrCtr_SetOptions(&tmrctr, 1, XTC_DOWN_COUNT_OPTION | XTC_EXT_COMPARE_OPTION | XTC_PWM_ENABLE_OPTION);

	XTmrCtr_SetResetValue(&tmrctr, 0, 1000000); // period
	XTmrCtr_SetResetValue(&tmrctr, 1, 75000); // high time

	XTmrCtr_Start(&tmrctr, 0);
	XTmrCtr_Start(&tmrctr, 1);
}
